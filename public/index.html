<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>Speechify</title>
	<link rel="stylesheet" href="css/style.css">
	<link href='https://fonts.googleapis.com/css?family=Shadows+Into+Light' rel='stylesheet' type='text/css'>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
</head>
<body>
	<h1>Speechify</h1>
	<div class="speech">
		<p></p>
	</div>
</body>
</html>
<script>
$(document).ready(function(){
	function appendText(id){
		$.ajax({
		  dataType: "json",
		  url: "/" + id + ".json",
		  success: function(data) {
		  	var text = loadHinge(data.ngrams, data.text)
			$('.speech > p').append(text);
			$('.speech > p').append("</br>");
		  }
		});
	};

	function loadHinge(ngrams, text){
		for (var x = 0; x < ngrams.length; x++) {
			var lowerCaseText = text.toLowerCase();
			var current = ngrams[x].term.toLowerCase();
			if (lowerCaseText.indexOf(current > -1)){
				var term = text.slice(lowerCaseText.indexOf(current), (lowerCaseText.indexOf(current) + current.length));
				var hinge = '<span id="' + ngrams[x].slug + '" class="hinge">' + term + '<div class="links"><p class="nextText" data-id="1">MLK</p><p class="nextText" data-id="2">MLK</p></div></span>';
				text = text.replace(term, hinge);
			}
		}
		return text;
	}

	appendText(1);


	$('.speech').click(function(e){
		if (e.target.className === "nextText"){
			var id = $(e.target).data('id');
			appendText(id);
		};
	});

});
</script>
