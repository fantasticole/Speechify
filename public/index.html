<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>Speechify</title>
	<link rel="stylesheet" href="css/style.css">
	<link href='https://fonts.googleapis.com/css?family=Shadows+Into+Light' rel='stylesheet' type='text/css'>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
</head>
<body>
	<h1>Speechify</h1>
	<div class="speech">
	</div>
</body>
</html>
<script>
$(document).ready(function(){
	function appendText(){
		$.ajax({
		  dataType: "json",
		  url: "/1.json",
		  success: function(data) {
		  	var text = loadHinge(data.ngrams, data.text)
			$('.speech').append('<p>' + text + '</p>');
		  }
		});
	};

	function loadHinge(ngrams, text){
		for (var x = 0; x < ngrams.length; x++) {
			var lowerCaseText = text.toLowerCase();
			var current = ngrams[x].term.toLowerCase();
			if (lowerCaseText.indexOf(current > -1)){
				var term = text.slice(lowerCaseText.indexOf(current), (lowerCaseText.indexOf(current) + current.length));
				var hinge = '<span id="' + ngrams[x].slug + '" class="hinge">' + term + '<div class="links"><p data-id="2">MLK</p></div></span>';
				text = text.replace(term, hinge);
			}
		}
		return text;
	}

	appendText();


	$('.speech').click(function(e){
		if (e.target.className === "hinge"){
			console.log(e.target);
		};
	});

	$('.hinge').click(function(){
		var nextSlug = this.id;
		var hinge = this;



		$.ajax({
		  dataType: "json",
		  url: "/2.json",
		  success: function(data) {
			  appendNext(data, hinge);
		  }
		});
	});

	function appendNext(data, hinge) {
		var author = data.author;
		var text = data.text.slice(0, 200) + '...';
		var ngrams = data.ngrams;
		console.log('author:', author);
		console.log('text:', text);
		console.log('ngrams:', ngrams);
		console.log(hinge);
		$(hinge).append('<div class="links"><p data-id="' + data.id + '">' + title + '</p></div>');

	}
});
</script>
